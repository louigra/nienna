<!doctype html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nienna — Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
  <link href="./styles.css" rel="stylesheet" />
</head>
<body>
  <div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <h1 class="h4 mb-1">Nienna Dashboard</h1>
        <div id="user-info" class="text-secondary small"></div>
      </div>
      <button id="signout-btn" class="btn btn-outline-light">Sign out</button>
    </div>

    <!-- Tiles -->
    <div class="row g-3">
      <div class="col-12 col-md-6 col-lg-4">
        <a class="text-decoration-none" href="projects.html">
          <div class="card h-100 shadow-sm hover-lift">
            <div class="card-body">
              <h5 class="card-title">Projects</h5>
              <p class="card-text text-secondary">Browse CIP projects and allocations.</p>
            </div>
          </div>
        </a>
      </div>

      <div class="col-12 col-md-6 col-lg-4">
        <a class="text-decoration-none" href="inflators.html">
          <div class="card h-100 shadow-sm hover-lift">
            <div class="card-body">
              <h5 class="card-title">Inflators</h5>
              <p class="card-text text-secondary">View inflation indices / years.</p>
            </div>
          </div>
        </a>
      </div>

      <div class="col-12 col-md-6 col-lg-4">
        <a class="text-decoration-none" href="cip.html">
          <div class="card h-100 shadow-sm hover-lift">
            <div class="card-body">
              <h5 class="card-title">CIP Info</h5>
              <p class="card-text text-secondary">Program start/end years & metadata.</p>
            </div>
          </div>
        </a>
      </div>
    </div>

    <p class="text-secondary small mt-3" id="status"></p>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  <script type="module">
    import { supabase, requireAuth } from "./auth-guard.js";

    const status = document.getElementById('status');
    const userInfo = document.getElementById('user-info');

    // guard
    const session = await requireAuth();
    userInfo.textContent = `${session.user.email} | user_id: ${session.user.id}`;
    status.textContent = 'Signed in ✓';

    document.getElementById('signout-btn').onclick = async () => {
      await supabase.auth.signOut();
      window.location.href = "index.html";
    };
  </script>
</body>
</html>